
version: '{branch}-{build}'

install:
  - "SET PATH=C:\\Python36-x64;C:\\Python36-x64\\Scripts;%PATH%"
  - "python --version"
  - "pip install --disable-pip-version-check --user --upgrade pip==9.0.1"
  - "pip install tox==2.9.1 virtualenv==15.1.0"
#  - "pip install -rrequirements.txt -rrequirements-dev.txt"

# Build the binary after tests
build: false

test_script:
  - "tox -e py27,py36 -- tests/unit"
  # tox uses an outdated version of pip which breaks attempting to execute tox -e py36
  # Instead, we run the test command directly in the native (py3.6) environment
  # - "py.test -v --cov=compose --cov-report html --cov-report term --cov-config=tox.ini tests/unit"
  - ps: ".\\script\\build\\windows.ps1"

artifacts:
  - path: .\dist\docker-compose-Windows-x86_64.exe
    name: "Compose Windows binary"

deploy:
  - provider: Environment
    name: master-builds
    on:
      branch: master
